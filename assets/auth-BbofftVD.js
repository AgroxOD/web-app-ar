function s(){return localStorage.getItem("jwt")}function u(t){try{const[,e]=t.split(".");if(!e)return{};const o=atob(e.replace(/-/g,"+").replace(/_/g,"/"));return JSON.parse(o)}catch{return{}}}function l(t){t&&localStorage.setItem("jwt",t)}function a(t){t&&localStorage.setItem("role",t)}function g(t,e){if(l(t),e)a(e);else{const{role:o}=u(t);o&&a(o)}}function d(){localStorage.removeItem("jwt"),localStorage.removeItem("role")}function h(){return!!s()}const f="";async function c(t,e,o){const i=f+t,n=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),r=await n.json().catch(()=>({}));if(!n.ok)throw new Error(r.error||`${o}: ${n.status}`);return r}function p(t,e){return c("/auth/login",{email:t,password:e},"Login failed")}function S(t,e,o){return c("/auth/register",{username:t,email:e,password:o},"Register failed")}export{u as decodeJwt,s as getToken,h as isAuthenticated,p as login,d as logout,S as register,g as setAuth,a as setRole,l as setToken};
