import"./style-D_zl4slf.js";import{login as m,setToken as a,register as r,logout as s,isAuthenticated as i}from"./auth-CFXlDKj2.js";import{loadModels as c}from"./models-DtFjBj2Q.js";async function o(){const e=document.getElementById("model-list");e.innerHTML="";try{(await c()).forEach(n=>{const d=document.createElement("li");d.textContent=`${n.name} (${n.url})`,e.appendChild(d)})}catch{}}function l(){const e=i();document.getElementById("login-form").style.display=e?"none":"inline",document.getElementById("register-form").style.display=e?"none":"inline",document.getElementById("logout").classList.toggle("hidden",!e),document.getElementById("upload-form").classList.toggle("hidden",!e)}document.getElementById("login-form").addEventListener("submit",async e=>{e.preventDefault();try{const{jwt:t}=await m(document.getElementById("login-email").value,document.getElementById("login-password").value);a(t),l(),await o()}catch{alert("Login failed")}});document.getElementById("register-form").addEventListener("submit",async e=>{e.preventDefault();try{const{jwt:t}=await r(document.getElementById("reg-username").value,document.getElementById("reg-email").value,document.getElementById("reg-password").value);a(t),l(),await o()}catch{alert("Register failed")}});document.getElementById("logout").addEventListener("click",()=>{s(),l(),document.getElementById("model-list").innerHTML=""});document.getElementById("upload-form").addEventListener("submit",async e=>{e.preventDefault();const t=document.getElementById("file"),n=new FormData;t.files[0]&&n.append("model",t.files[0]);try{if(!(await fetch("/upload",{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("jwt")}`},body:n})).ok)throw new Error("upload failed");t.value="",await o()}catch{alert("Upload failed")}});l();i()&&o();
