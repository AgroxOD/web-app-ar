function a(){return localStorage.getItem("jwt")}function i(t){try{const[,e]=t.split(".");if(!e)return{};const o=atob(e.replace(/-/g,"+").replace(/_/g,"/"));return JSON.parse(o)}catch{return{}}}function u(t){t&&localStorage.setItem("jwt",t)}function g(){const t=localStorage.getItem("role");if(t)return t;const e=a();if(e){const{role:o}=i(e);if(o)return localStorage.setItem("role",o),o}return"user"}function c(t){t&&localStorage.setItem("role",t)}function d(t,e){if(u(t),e)c(e);else{const{role:o}=i(t);o&&c(o)}}function h(){localStorage.removeItem("jwt"),localStorage.removeItem("role")}function S(){return!!a()}const f="";async function s(t,e,o){const l=f+t,n=await fetch(l,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),r=await n.json().catch(()=>({}));if(!n.ok)throw new Error(r.error||`${o}: ${n.status}`);return r}function m(t,e){return s("/auth/login",{email:t,password:e},"Login failed")}function p(t,e,o){return s("/auth/register",{username:t,email:e,password:o},"Register failed")}export{i as decodeJwt,g as getRole,a as getToken,S as isAuthenticated,m as login,h as logout,p as register,d as setAuth,c as setRole,u as setToken};
